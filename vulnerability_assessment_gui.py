import tkinter as tk
from tkinter import messagebox
from zapv2 import ZAPv2
import time
import json

class VulnerabilityScannerApp:
    def __init__(self, root):
        self.root = root
        self.root.title("Vulnerability Assessment Tool")
        self.api_key = tk.StringVar()
        self.target_url = tk.StringVar()

        tk.Label(root, text="ZAP API Key:").grid(row=0, column=0)
        tk.Entry(root, textvariable=self.api_key).grid(row=0, column=1)

        tk.Label(root, text="Target URL:").grid(row=1, column=0)
        tk.Entry(root, textvariable=self.target_url).grid(row=1, column=1)

        tk.Button(root, text="Start Scan", command=self.start_scan).grid(row=2, column=0, columnspan=2)

    def start_scan(self):
        api_key = self.api_key.get()
        target_url = self.target_url.get()
        zap = ZAPv2(apikey=api_key)

        zap.core.new_session(name='vulnerability_assessment', overwrite=True)
        zap.spider.scan(target_url)
        time.sleep(5)

        while (int(zap.spider.status()) < 100):
            time.sleep(2)

        zap.ascan.scan(target_url)
        while (int(zap.ascan.status()) < 100):
            time.sleep(5)

        alerts = zap.core.alerts()
        with open('vulnerability_report.json', 'w') as f:
            json.dump(alerts, f, indent=4)

        messagebox.showinfo("Scan Completed", "Vulnerability scan completed. Report saved to vulnerability_report.json")

root = tk.Tk()
app = VulnerabilityScannerApp(root)
root.mainloop()
